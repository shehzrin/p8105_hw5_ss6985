P8105 Homework 5
================
Shehzrin Shah
2024-11-07

## Problem 1

Create a function for size n that randomly draws birthdays for each
person, checks whether there are duplicate birthdays in the group, and
returns `TRUE` or `FALSE` based on the result.

``` r
bday_sim = function(n) {
  bdays = sample(1:365, size = n, replace = TRUE)
  duplicate = length(unique(bdays)) < n 
  return(duplicate)
}
```

Run this function 10,000 times for each group size between 2 and 50.

``` r
sim_res =
  expand_grid(n = 2:50,
              iter = 1:10000) |>
  mutate(res = map_lgl(n, bday_sim)) |>
  group_by(n) |>
  summarize(prob = mean(res))
```

Make a plot showing the probability that at least two people in the
group will share a birthday (by averaging across 10,000 simulation runs
for each group size between 2 and 50) as a function of group size.

``` r
sim_res |>
  ggplot(aes(x = n, y = prob)) +
  geom_line() +
  labs(title = "Probability of Shared Birthday in a Group",
       x = "Group Size",
       y = "Probability of Shared Birthday")
```

<img src="p8105_hw5_ss6985_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />

As n (# of people in a room) increases, the probability of a shared
birthday increases. When the group size is about 22 people, the
probability of a shared birthday is about 50%. With a group size of 50,
the probability is nearly 100% which suggests it is almost certain or
extremely likely that at least two people in the group will share a
birthday. I expect that increasing the group size even more would, at
some point, result in a 100% probability of a shared birthday.

## Problem 3

Import raw data obtained by the Washington Post on homicides in 50 large
U.S. cities.

``` r
homicide_df = 
  read_csv("homicide-data.csv", na = c("NA",".",""))
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

The Washington Post has gathered data on homicides across 50 large U.S.
cities over the past years, providing information on more than 52179
observations of homicide cases. This dataset contains 12 variables,
which are `uid`, `reported_date`, `victim_last`, `victim_race`,
`victim_age`, `victim_sex`, `city`, `state`, `lat`, `lon`, and
`disposition`. Each entry is information about a unique homicide
incident, the victim’s demographics, and the case resolution status.

Create a `citystate_df` variable. Summarize within cities to obtain the
total number of homicides and the number of unsolved homicides.

``` r
citystate_df = homicide_df |>
  janitor::clean_names() |>
  mutate(
    city_state = str_c(city, ", ", state), 
    unsolved = disposition %in% c("Closed without arrest", "Open/No arrest")
    ) |>
  group_by(city_state) |>
  summarize(
    total_homicides = n(),
    unsolved_homicides = sum(unsolved, na.rm = TRUE)
  ) 
```

Estimate the proportion of homicides that are unsolved in Baltimore, MD.

``` r
baltimore_df = citystate_df |>
  filter(city_state == "Baltimore, MD") |>
  select (-city_state) |>
  as.matrix()|>
  prop.test() 

baltimore_tidy_result = broom::tidy(baltimore_df) |>
  select(estimate, conf.low, conf.high) |>
  knitr::kable()

baltimore_tidy_result
```

|  estimate |  conf.low | conf.high |
|----------:|----------:|----------:|
| 0.6076956 | 0.5934734 | 0.6217388 |

Extract both the proportion of unsolved homicides and the confidence
interval for each of the cities.

``` r
cities_df = citystate_df |>
  mutate(
    prop_test = map2(unsolved_homicides, total_homicides, ~ prop.test(x = .x, n = .y)),
    tidy_result = map(prop_test, broom::tidy) 
  ) |>
  unnest(tidy_result) |>
  select(city_state, estimate, conf.low, conf.high) 
```

Create a plot that shows the estimates and CIs for each city.

``` r
cities_df = cities_df |> 
  arrange(desc(estimate)) |> 
  mutate(city_state = fct_reorder(city_state, estimate))

ggplot(cities_df, aes(x = city_state, y = estimate)) +
  geom_point() +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +
  labs(
    title = "Proportion of Unsolved Homicides by City",
    x = "City",
    y = "Proportion of Unsolved Homicides",
    caption = "Confidence intervals are based on a 95% confidence level"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
```

<img src="p8105_hw5_ss6985_files/figure-gfm/unnamed-chunk-9-1.png" width="90%" />
